import sys
import os
scriptpath = "/na/homes/cfreeman/Documents/virtual_test_environment/gunfolds/tools"
sys.path.append(os.path.abspath(scriptpath))
import traversal, bfutils, graphkit,unknownrate




#input: G 
#output: [G^1,G^2,G^3....G^umax]
def conversionFunction(G):
	return bfutils.call_undersamples(G) #umax = len(gs)


#input: G
#output: cardinality of the codomain 
def determine_codomain_cardinality(G):
	n = len(G)
	exponent = n**2 + choose(n,2)
	return 2**exponent


########helper functions###################################################################

#input: n, k
#ouput n choose k
def choose(n, k):
    if 0 <= k <= n:
        ntok = 1
        ktok = 1
        for t in xrange(1, min(k, n - k) + 1):
            ntok *= n
            ktok *= t
            n -= 1
        return ntok // ktok
    else:
        return 0
	

##################testing area#######################################
G = {'1': {'2': set([(0, 1)])}, '3': {'4': set([(0, 1)])}, '2': {'3': set([(0, 1)])}, '5': {'1': set([(0, 1)])}, '4': {'1': set([(0, 1)]), '5': set([(0, 1)])}}
G2 = {'1': {'3': set([(0, 1)]), '5': set([(2, 0)])}, '3': {'1': set([(0, 1)]), '5': set([(0, 1)])}, '2': {'4': set([(0, 1)])}, '5': {'1': set([(2, 0)]), '2': set([(0, 1)])}, '4': {'1': set([(0, 1)]), '2': set([(0, 1)])}}

#created from call_undersamples
call_undersamples_G = [{'1': {'2': set([(0, 1)])}, '3': {'4': set([(0, 1)])}, '2': {'3': set([(0, 1)])}, '5': {'1': set([(0, 1)])}, '4': {'1': set([(0, 1)]), '5': set([(0, 1)])}}, {'1': {'3': set([(0, 1)]), '5': set([(2, 0)])}, '3': {'1': set([(0, 1)]), '5': set([(0, 1)])}, '2': {'4': set([(0, 1)])}, '5': {'1': set([(2, 0)]), '2': set([(0, 1)])}, '4': {'1': set([(0, 1)]), '2': set([(0, 1)])}}, {'1': {'2': set([(2, 0)]), '5': set([(2, 0)]), '4': set([(0, 1)])}, '3': {'1': set([(0, 1)]), '2': set([(0, 1)])}, '2': {'1': set([(0, 1), (2, 0)]), '5': set([(0, 1)])}, '5': {'1': set([(2, 0)]), '3': set([(0, 1)])}, '4': {'3': set([(0, 1)]), '2': set([(0, 1)])}}, {'1': {'1': set([(0, 1)]), '2': set([(2, 0)]), '5': set([(0, 1), (2, 0)])}, '3': {'3': set([(0, 1)]), '2': set([(0, 1), (2, 0)])}, '2': {'1': set([(0, 1), (2, 0)]), '3': set([(2, 0)]), '2': set([(0, 1)])}, '5': {'1': set([(2, 0)]), '4': set([(0, 1)])}, '4': {'3': set([(0, 1)]), '4': set([(0, 1)])}}, {'1': {'1': set([(0, 1)]), '2': set([(0, 1), (2, 0)]), '5': set([(2, 0)])}, '3': {'3': set([(0, 1)]), '2': set([(2, 0)]), '4': set([(0, 1), (2, 0)])}, '2': {'1': set([(2, 0)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1)])}, '5': {'1': set([(0, 1), (2, 0)]), '5': set([(0, 1)])}, '4': {'1': set([(0, 1)]), '3': set([(2, 0)]), '5': set([(0, 1)]), '4': set([(0, 1)])}}, {'1': {'3': set([(0, 1)]), '2': set([(0, 1), (2, 0)]), '5': set([(2, 0)]), '4': set([(2, 0)])}, '3': {'1': set([(0, 1)]), '2': set([(2, 0)]), '5': set([(0, 1)]), '4': set([(0, 1), (2, 0)])}, '2': {'1': set([(2, 0)]), '3': set([(0, 1), (2, 0)]), '4': set([(0, 1)])}, '5': {'1': set([(0, 1), (2, 0)]), '2': set([(0, 1)]), '4': set([(2, 0)])}, '4': {'1': set([(0, 1), (2, 0)]), '3': set([(2, 0)]), '2': set([(0, 1)]), '5': set([(0, 1), (2, 0)])}}, {'1': {'3': set([(0, 1)]), '2': set([(2, 0)]), '5': set([(2, 0)]), '4': set([(0, 1), (2, 0)])}, '3': {'1': set([(0, 1)]), '2': set([(0, 1), (2, 0)]), '5': set([(0, 1)]), '4': set([(2, 0)])}, '2': {'1': set([(0, 1), (2, 0)]), '3': set([(2, 0)]), '5': set([(0, 1), (2, 0)]), '4': set([(0, 1)])}, '5': {'1': set([(2, 0)]), '3': set([(0, 1)]), '2': set([(0, 1), (2, 0)]), '4': set([(2, 0)])}, '4': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1)]), '5': set([(2, 0)])}}, {'1': {'1': set([(0, 1)]), '3': set([(2, 0)]), '2': set([(2, 0)]), '5': set([(0, 1), (2, 0)]), '4': set([(0, 1), (2, 0)])}, '3': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1)]), '2': set([(0, 1), (2, 0)]), '4': set([(2, 0)])}, '2': {'1': set([(0, 1), (2, 0)]), '3': set([(2, 0)]), '2': set([(0, 1)]), '5': set([(0, 1), (2, 0)])}, '5': {'1': set([(2, 0)]), '3': set([(0, 1)]), '2': set([(2, 0)]), '4': set([(0, 1), (2, 0)])}, '4': {'1': set([(2, 0)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1)]), '5': set([(2, 0)]), '4': set([(0, 1)])}}, {'1': {'1': set([(0, 1)]), '3': set([(2, 0)]), '2': set([(0, 1), (2, 0)]), '5': set([(0, 1), (2, 0)]), '4': set([(2, 0)])}, '3': {'1': set([(2, 0)]), '3': set([(0, 1)]), '2': set([(0, 1), (2, 0)]), '4': set([(0, 1), (2, 0)])}, '2': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1)]), '5': set([(2, 0)]), '4': set([(2, 0)])}, '5': {'1': set([(0, 1), (2, 0)]), '2': set([(2, 0)]), '5': set([(0, 1)]), '4': set([(0, 1), (2, 0)])}, '4': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1), (2, 0)]), '2': set([(2, 0)]), '5': set([(0, 1), (2, 0)]), '4': set([(0, 1)])}}, {'1': {'1': set([(0, 1)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1), (2, 0)]), '5': set([(2, 0)]), '4': set([(2, 0)])}, '3': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1)]), '2': set([(2, 0)]), '5': set([(0, 1), (2, 0)]), '4': set([(0, 1), (2, 0)])}, '2': {'1': set([(2, 0)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1)]), '5': set([(2, 0)]), '4': set([(0, 1), (2, 0)])}, '5': {'1': set([(0, 1), (2, 0)]), '3': set([(2, 0)]), '2': set([(0, 1), (2, 0)]), '5': set([(0, 1)]), '4': set([(2, 0)])}, '4': {'1': set([(0, 1), (2, 0)]), '3': set([(2, 0)]), '2': set([(0, 1), (2, 0)]), '5': set([(0, 1), (2, 0)]), '4': set([(0, 1)])}}, {'1': {'3': set([(0, 1), (2, 0)]), '2': set([(0, 1), (2, 0)]), '5': set([(2, 0)]), '4': set([(0, 1), (2, 0)])}, '3': {'1': set([(0, 1), (2, 0)]), '2': set([(0, 1), (2, 0)]), '5': set([(0, 1), (2, 0)]), '4': set([(0, 1), (2, 0)])}, '2': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1), (2, 0)]), '5': set([(0, 1), (2, 0)]), '4': set([(0, 1), (2, 0)])}, '5': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1), (2, 0)]), '4': set([(2, 0)])}, '4': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1), (2, 0)]), '5': set([(0, 1), (2, 0)])}}, {'1': {'1': set([(0, 1)]), '3': set([(0, 1), (2, 0)]), '2': set([(2, 0)]), '5': set([(0, 1), (2, 0)]), '4': set([(0, 1), (2, 0)])}, '3': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1)]), '2': set([(0, 1), (2, 0)]), '5': set([(0, 1), (2, 0)]), '4': set([(2, 0)])}, '2': {'1': set([(0, 1), (2, 0)]), '3': set([(2, 0)]), '2': set([(0, 1)]), '5': set([(0, 1), (2, 0)]), '4': set([(0, 1), (2, 0)])}, '5': {'1': set([(2, 0)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1), (2, 0)]), '4': set([(0, 1), (2, 0)])}, '4': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1), (2, 0)]), '5': set([(2, 0)]), '4': set([(0, 1)])}}, {'1': {'1': set([(0, 1)]), '3': set([(2, 0)]), '2': set([(0, 1), (2, 0)]), '5': set([(0, 1), (2, 0)]), '4': set([(0, 1), (2, 0)])}, '3': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1)]), '2': set([(0, 1), (2, 0)]), '5': set([(2, 0)]), '4': set([(0, 1), (2, 0)])}, '2': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1)]), '5': set([(0, 1), (2, 0)]), '4': set([(2, 0)])}, '5': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1), (2, 0)]), '2': set([(2, 0)]), '5': set([(0, 1)]), '4': set([(0, 1), (2, 0)])}, '4': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1), (2, 0)]), '5': set([(0, 1), (2, 0)]), '4': set([(0, 1)])}}, {'1': {'1': set([(0, 1)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1), (2, 0)]), '5': set([(0, 1), (2, 0)]), '4': set([(2, 0)])}, '3': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1)]), '2': set([(0, 1), (2, 0)]), '5': set([(0, 1), (2, 0)]), '4': set([(0, 1), (2, 0)])}, '2': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1)]), '5': set([(2, 0)]), '4': set([(0, 1), (2, 0)])}, '5': {'1': set([(0, 1), (2, 0)]), '3': set([(2, 0)]), '2': set([(0, 1), (2, 0)]), '5': set([(0, 1)]), '4': set([(0, 1), (2, 0)])}, '4': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1), (2, 0)]), '5': set([(0, 1), (2, 0)]), '4': set([(0, 1)])}}, {'1': {'1': set([(0, 1)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1), (2, 0)]), '5': set([(2, 0)]), '4': set([(0, 1), (2, 0)])}, '3': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1)]), '2': set([(0, 1), (2, 0)]), '5': set([(0, 1), (2, 0)]), '4': set([(0, 1), (2, 0)])}, '2': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1)]), '5': set([(0, 1), (2, 0)]), '4': set([(0, 1), (2, 0)])}, '5': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1), (2, 0)]), '5': set([(0, 1)]), '4': set([(2, 0)])}, '4': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1), (2, 0)]), '5': set([(0, 1), (2, 0)]), '4': set([(0, 1)])}}, {'1': {'1': set([(0, 1)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1), (2, 0)]), '5': set([(0, 1), (2, 0)]), '4': set([(0, 1), (2, 0)])}, '3': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1)]), '2': set([(0, 1), (2, 0)]), '5': set([(0, 1), (2, 0)]), '4': set([(0, 1), (2, 0)])}, '2': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1)]), '5': set([(0, 1), (2, 0)]), '4': set([(0, 1), (2, 0)])}, '5': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1), (2, 0)]), '4': set([(0, 1), (2, 0)])}, '4': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1), (2, 0)]), '5': set([(0, 1), (2, 0)]), '4': set([(0, 1)])}}, {'1': {'1': set([(0, 1)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1), (2, 0)]), '5': set([(0, 1), (2, 0)]), '4': set([(0, 1), (2, 0)])}, '3': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1)]), '2': set([(0, 1), (2, 0)]), '5': set([(0, 1), (2, 0)]), '4': set([(0, 1), (2, 0)])}, '2': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1)]), '5': set([(0, 1), (2, 0)]), '4': set([(0, 1), (2, 0)])}, '5': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1), (2, 0)]), '5': set([(0, 1)]), '4': set([(0, 1), (2, 0)])}, '4': {'1': set([(0, 1), (2, 0)]), '3': set([(0, 1), (2, 0)]), '2': set([(0, 1), (2, 0)]), '5': set([(0, 1), (2, 0)]), '4': set([(0, 1)])}}]


print len(call_undersamples_G) #17
print len(all_undersamples_G) #15

